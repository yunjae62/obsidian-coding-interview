### TCP
- TCP/IP 모델의 전송계층(OSI 모델은 4계층)에서 사용되는 신뢰성 있고 연결 지향의 프로토콜. 데이터 전송 단위는 세그먼트이다.
- 주요 특징으로 흐름제어, 혼잡제어, 3-way handshake가 있다.
- 다른 프로토콜로는 UDP가 있으며, 무신뢰성의 비연결 지향 프로토콜이다. 데이터 전송 단위는 데이터그램이다.

### 3-way handshake
- TCP 연결의 시작 단계로, 클라이언트와 서버 간의 신뢰성 있는 연결을 하기 위해 3번의 메시지를 주고받는 과정이다.
- TCP 세그먼트는 헤더와 페이로드로 구성되었으며, 헤더 내에는 SYN(연결 요청), ACK(응답 확인)와 같은 여러 제어 플래그가 존재한다.
	1. (클라 -> 서버) SYN 세그먼트 전송
		- 클라이언트가 연결 시작함
		- SYN = 1, seq = x (임의의 초기 순서 번호), 윈도우 크기 (Window Size) 정보 포함
	2. (서버 -> 클라) SYN + ACK 세그먼트 전송
		- 연결 수락 + 클라이언트 요청에 대한 응답
		- SYN = 1, ACK = 1, seq = y (서버의 초기 임의 순서 번호), ack = x + 1 (클라의 값에 1 추가)
	3. (클라 -> 서버) ACK 세그먼트 전송
		- 서버의 응답에 대한 확인
		- ACK = 1, seq = x + 1, ack = y + 1
		- 정상 요청 시 연결 완료

### 흐름제어 (Flow Control)
- 수신 측의 처리 능력을 고려하여, 송신 측이 너무 많은 데이터를 전송하지 않도록 제어하는 것
- 수신자가 데이터를 처리하기 전에 너무 많이 보내면 버퍼가 넘쳐서 손실 발생
- 이를 방지하기 위해, 슬라이딩 윈도우(Sliding Window) 방식을 사용함
	- 윈도우 크기 (Window Size) : 수신자가 현재 받을 수 있는 데이터의 크기를 송신자에게 알림
- 수신자가 ACK와 함께 새로운 윈도우 크기를 전달하며 흐름 제어

### 혼잡제어 (Congestion Control)
- 네트워크 자체의 혼잡 상황을 고려하여, 전체 네트워크 부하를 줄이기 위한 제어
- 너무 많은 호스트가 동시에 데이터를 보내면 네트워크 상의 중간 장비가 혼잡해져 패킷 손실 발생
- 이를 방지하기 위해 전송 속도를 조절하면서 혼잡 방지
- 혼잡 윈도우 (cwnd, Congestion Window) : 송신자가 한 번에 전송할 수 있는 데이터의 최대 크기
- 슬로우 스타트 임계값 (ssthresh, Slow Start Threshold) : 혼잡 윈도우가 지수 증가에서 선형 증가로 전환되는 기준값. 일반적으로 혼잡 발생 시 혼잡 윈도우의 절반으로 설정됨
- 주요 단계
	- 슬로우 스타트 (Slow Start)
		- 처음에는 낮은 속도로 시작해서 혼잡 윈도우를 2의 배수로 증가시킴 (1, 2, 4, 8)
		- 조건 : cwnd < ssthresh
	- 혼잡 회피 (Congestion Avoidance)
		- 일정 수준 도달 후부터는 선형으로 증가 (한 RTT 당 cwnd += 1)
		- 조건 : cwnd >= ssthresh
	- 빠른 재전송 (Fast Retransmit)
		- 패킷 손실이 감지되면 (중복 ACK 3번) 빠르게 (타이머 만료 전) 즉시 재전송 
	- 빠른 복구 (Fast Recovery)
		- 패킷 손실 시 ssthresh = cwnd / 2 로 감소 후 cwnd = ssthresh로 설정하여 혼잡 회피부터 다시 시작

### 4-way Handshake
- TCP 연결의 종료 단계로, 종료 시에도 신뢰성을 보장하기 위해 양쪽이 각각 종료 의사를 따로 표현하는 4단계 절차를 거침
	1. (클라 -> 서버) : FIN세그먼트 전송
		- 클라이언트가 연결 종료 의사 전송
		- 클라이언트는 FIN_WAIT_1 상태로 전이
	- (서버 -> 클라) : ACK 세그먼트 전송
		- 서버가 FIN 수신 확인하고 ACK 응답
		- 클라이언트는 FIN_WAIT_2 상태로 전이
	- (서버 -> 클라) : FIN 세그먼트 전송
		- 서버도 연결 종료 의사 전송
		- 서버는 LAST_ACK 상태로 전이
	- (클라 -> 서버) : ACK 세그먼트 전송
		- 클라이언트가 FIN 수신 확인하고 ACK 응답
		- 클라이언트는 TIME_WAIT 상태로 진입, 지연된 패킷을 위한 대기 후 종료
		- 서버는 CLOSED 상태로 전환
